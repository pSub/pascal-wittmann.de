# Define site attributes
name = "www.pascal-wittmann.de"
protocol = "https"
approute = protocol + "://" + name + "/"

# Redirect when visiting without SSL
$SERVER["socket"] == ":80" {
  url.redirect = ( "^/(.*)" => approute + "$1")
}

# Redirect when visiting without www prefix
$HTTP["host"] == "pascal-wittmann.de" {
  url.redirect = ( "^/(.*)" => approute + "$1")

  # Serve ssl certifiates
  $SERVER["socket"] == ":443" {
     ssl.engine                  = "enable" 
     ssl.pemfile                 = "/etc/lighttpd/ssl/www.pascal-wittmann.de.pem" 
     ssl.ca-file                 = "/etc/lighttpd/ssl/ca-certs.crt"
  }

}

# Main Handler
$HTTP["host"] == "www.pascal-wittmann.de" {

  # Serve ssl certificates
  $SERVER["socket"] == ":443" {
     ssl.engine                  = "enable" 
     ssl.pemfile                 = "/etc/lighttpd/ssl/www.pascal-wittmann.de.pem" 
     ssl.ca-file                 = "/etc/lighttpd/ssl/ca-certs.crt"
  }

  # Serve content via wai
  proxy.balance = "hash"
  proxy.server  = ( "" => ( ( "host" => "127.0.0.1", "port" => 3001 ),
                            ( "host" => "127.0.0.1", "port" => 3002 ) ) )

  # Permanent redirects for old links
  url.redirect = (
        "log/linux/31/kleine\+Backup\-Erinnerung\.html" => approute + "category/Blog/entry/backup-helper",
        "log/31/kleine\+Backup\-Erinnerung\.html" => approute + "category/Blog/entry/backup-helper",
	"log/zsh/30/suffix\+aliases\+im\+Hintergrund\+starten\.html" => approute + "category/Blog/entry/suffix-aliases",
	"log/linux/28/\(Noch\)\+Mehr\+Spaß\+in\+der\+Shell\+mit\+moreutils\.html" => approute + "category/Blog/entry/vorstellung-moreutils",
	"log/zsh/27/Schneller\+mit\+der\+Tilde\+\(\~\)\+arbeiten\.html" => approute + "category/Blog/entry/tilde-trick",
	"log/irc/26/weechat\%3A\+lag\_min\_show\+ist\+nun\+in\+Millisekunden\.html" => approute + "category/Blog/entry/lag-min-show",
	"referate/geschichte/29/Die\+Rolle\+des\+Liberalismus\+in\+der\+europäischen\+Geschichte\.html" => approute + "category/Referate/entry/liberalismus-europäische-geschichte",
	"referate/ethik/20/Die\+Debatte\+um\+adulte\+und\+embryonale\+Stammzellen\+in\+der\+europäischen\+Union\.html" => approute + "category/Referate/entry/stammzelldebatte-in-europa",
	"referate/mathematik/2/lineare\+Regression\+\(Handout\)\.html" => approute + "category/Referate/entry/lineare-regression",
	"referate/mathematik/15/Lineare\+Regression\+\(Folien\)\.html" => approute + "category/Referate/entry/lineare-regression",
	"referate/geschichte/1/Friedliche\+neue\+Weltordnung\.html" => approute + "category/Referate/entry/friedliche-neue-weltordnung",
	"referate/powi/16/Zionismus\+und\+israelisches\+Staatsbürgerschaftsrecht\.html" => approute + "category/Referate/entry/zionismus-staatsbürgerschaft",
	"referate/ethik/14/Zeitleiste\+des\+Zionismus\.html" => approute + "category/Referate/entry/zeitleiste-zionismus",
	"referate/deutsch/4/Marthens\+Garten\.html" => approute + "category/Referate/entry/marthens-garten",
	"referate/deutsch/17/Interpretation\+von\+\%22Mondnacht\%22\.html" => approute + "category/Referate/entry/mondnacht",
	"referate/ethik/3/Paul\+Krugman\.html" => approute + "category/Referate/entry/paul-krugman",
	"referate/ethik/13/Mythen\%2C\+Philosophie\+und\+Ethik\.html" => approute + "category/Referate/entry/mythe-philosophie-ethik",
	"referate/ethik/18/Ethik\+in\+der\+Bibel\+und\+im\+frühen\+Christentum\.html" => approute + "category/Referate/entry/ethik-bibel-christentum",
	"referate/deutsch/11/Wie\+frei\+ist\+der\+Mensch\%3F\.html" => approute + "category/Referate/entry/wie-frei-ist-der-mensch",
	"referate/deutsch/12/Leitfaden\+zur\+Sachtextanalyse\.html" => approute + "category/Referate/entry/leitfaden-sachtextanalyse",
	"referate/deutsch/7/Die\+Vielzahl\+der\+Helden\.html" => approute + "category/Referate/entry/vielzahl-der-helden",
	"referate/ethik/19/Historisch\-kritische\+Methode\+der\+Exegese\.html" => approute + "category/Referate/entry/hist-krit-exegese",
	"referate/englisch/9/Interpretation\+of\+\'Stars\'\.html" => approute + "category/Referate/entry/interpretation-stars",
	"referate/deutsch/6/Innerer\+Monolog\+des\+Fulganzio\.html" => approute + "category/Referate/entry/innerer-monolog-fulganzio",
	"referate/deutsch/10/Interpretation\+von\+\%22Das\+Dicke\+Kind\%22.html" => approute + "category/Referate/entry/das-dicke-kind",
	"referate/deutsch/5/Die\+unwürdige\+Greisin\.html" => approute + "category/Referate/entry/unwürdige-greisin",
	"referate/deutsch/8/Heimkehr\.html" => approute + "category/Referate/entry/heimkehr",
	"^/pdf/(.*)" => approute + "static/$1",
	"home.html" => approute,
	"impressum.html" => approute + "impressum",
	"log.html" => approute + "category/Blog",
	"referate.html" => approute + "category/Referate",
	"referate/(.*).html" => approute + "category/Referate/tags/$1",
	"log/(.*).html" => approute + "category/Blog/tags/$1"
	)
} 
